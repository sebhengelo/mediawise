jQuery(function(t){function a(){}function i(){t.ajax({url:simple_favorites.ajaxurl,type:"post",datatype:"json",data:{action:"simplefavoritesnonce"},success:function(t){e(t.nonce)}})}function e(a){var i='<script type="text/javascript"> var simple_favorites_nonce = "'+a+'" ;</script>';t("head").append(i)}function s(){t.ajax({url:simple_favorites.ajaxurl,type:"post",datatype:"json",data:{action:"simplefavorites_array"},success:function(a){var i=[];t.each(a.favorites,function(t,a){i[t]=a}),o(i)}})}function o(a){var i=t(".simplefavorite-button");t.each(i,function(i){for(var e=t(this).data("postid"),s=t(this).data("siteid"),o=t(this).data("favoritecount"),c="",i=0;i<a.length;i++)a[i].site_id===s&&(r(e,a[i].site_favorites)?(c=n(simple_favorites.favorited,o),t(this).addClass("active").html(c)):(c=n(simple_favorites.favorite,o),t(this).removeClass("active").html(c)),t(this).removeClass("loading"))})}function n(t,a){return"1"===simple_favorites.includecount&&(t+=' <span class="simplefavorite-button-count">'+a+"<span>"),t}function r(a,i){var e=!1;return t.each(i,function(t,i){i===a&&(e=!0),parseInt(i)===a&&(e=!0)}),e}function c(){var a=t(".favorites-list");t.each(a,function(){var a=t(this).data("userid"),i=t(this).data("siteid"),e=t(this).data("links"),s=t(this);l(s,a,i,e)})}function l(a,i,e,s){"0"===i&&(i=null),t.ajax({url:simple_favorites.ajaxurl,type:"post",datatype:"json",data:{action:"simplefavorites_list",userid:i,siteid:e,links:s},success:function(i){t(a).replaceWith(i.list)}})}function d(i){var e=t(i).data("postid"),s=t(i).data("siteid"),o=parseInt(t(i).attr("data-favoritecount")),r="inactive",c="",l="";t(i).hasClass("active")?(t(i).removeClass("active"),0>o-1&&(o=1),t(i).attr("data-favoritecount",o-1),l=n(simple_favorites.favorite,o-1),c=f(l,r),t(i).html(c)):(r="active",t(i).addClass("active"),t(i).attr("data-favoritecount",o+1),l=n(simple_favorites.favorited,o+1),c=f(l,r),t(i).html(c)),t.ajax({url:simple_favorites.ajaxurl,type:"post",datatype:"json",data:{action:"simplefavorites",nonce:simple_favorites_nonce,postid:e,siteid:s,status:r},success:function(){t(i).removeClass("loading"),t(i).html(l),t(i).attr("disabled",!1),a(e,r,s)}})}function f(t,a){return"1"!==simple_favorites.indicate_loading?t:"active"===a?simple_favorites.loading_text+simple_favorites.loading_image_active:simple_favorites.loading_text+simple_favorites.loading_image}t(document).ready(function(){i()}),t(document).ready(function(){s(),c()}),t(document).on("click",".simplefavorite-button",function(a){a.preventDefault();var i=t(this);t(this).addClass("loading"),t(this).attr("disabled","disabled"),d(i)})});